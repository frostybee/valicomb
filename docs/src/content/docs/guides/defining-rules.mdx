---
title: Defining Rules
description: Learn the three ways to define validation rules in Valicomb
---

Valicomb provides three flexible syntaxes for defining validation rules. Choose the one that best fits your use case.

## 1. Fluent/Chained Syntax

The most explicit and readable approach. Best for step-by-step rule definition.

```php
use Frostybee\Valicomb\Validator;

$v = new Validator($_POST);
$v->rule('required', 'email')
  ->rule('email', 'email')
  ->rule('lengthMin', 'email', 5);
```

### Advantages

- Most explicit and readable
- Easy to add custom messages per rule
- Natural chaining with `->message()` and `->label()`

### Adding Messages and Labels

```php
$v->rule('required', 'email')
  ->message('We need your email address!')
  ->label('Email Address');
```

---

## 2. Rule-Based Array Syntax

Best when applying the same rule to many fields. Groups rules by rule type.

```php
use Frostybee\Valicomb\Validator;

$v = new Validator($_POST);
$v->rules([
    'required' => ['name', 'email'],
    'email' => 'email',
    'lengthBetween' => [
        ['name', 1, 100],
        ['bio', 10, 500]
    ]
]);
```

### Structure

```php
$v->rules([
    'ruleName' => 'field',                    // Single field
    'ruleName' => ['field1', 'field2'],       // Multiple fields
    'ruleName' => [['field', param1, param2]] // With parameters
]);
```

### Complete Example

```php
$v->rules([
    'required' => ['username', 'email', 'password'],
    'email' => 'email',
    'lengthMin' => [
        ['username', 3],
        ['password', 8]
    ],
    'lengthMax' => [
        ['username', 20],
        ['password', 128]
    ]
]);
```

---

## 3. Field-Based Array Syntax

Best when organizing validation by field. Groups rules by field name.

```php
use Frostybee\Valicomb\Validator;

$v = new Validator($_POST);
$v->mapManyFieldsToRules([
    'name' => ['required', ['lengthMin', 2]],
    'email' => ['required', 'email', ['lengthMax', 254]]
]);
```

### Structure

```php
$v->mapManyFieldsToRules([
    'field_name' => [
        'ruleName',              // Rule without parameters
        ['ruleName', param1],    // Rule with parameters
        ['ruleName', param1, 'message' => 'Custom message']
    ]
]);
```

### With Custom Messages

```php
$v->mapManyFieldsToRules([
    'email' => [
        ['required', 'message' => 'Email is required'],
        ['email', 'message' => 'Please enter a valid email']
    ],
    'password' => [
        ['required', 'message' => 'Password is required'],
        ['lengthMin', 8, 'message' => 'Password must be at least 8 characters']
    ]
]);
```

### Single Field Variant

For a single field, use `mapOneFieldToRules()`:

```php
$v->mapOneFieldToRules('email', [
    ['required'],
    ['email'],
    ['lengthMax', 254]
]);
```

---

## Applying Rules to Multiple Fields

All syntaxes support applying a rule to multiple fields at once:

### Fluent Syntax

```php
$v->rule('required', ['email', 'name', 'password']);
```

### Array Syntax

```php
$v->rules([
    'required' => ['email', 'name', 'password']
]);
```

---

## Mixing Syntaxes

You can mix syntaxes in the same validator:

```php
$v = new Validator($_POST);

// Start with array syntax for common rules
$v->rules([
    'required' => ['email', 'password']
]);

// Add specific rules with fluent syntax
$v->rule('email', 'email')
  ->message('Please enter a valid email address');

// Add field-specific complex validation
$v->mapOneFieldToRules('password', [
    ['lengthMin', 8],
    ['regex', '/[A-Z]/', 'message' => 'Must contain uppercase'],
    ['regex', '/[0-9]/', 'message' => 'Must contain a number']
]);
```

---

## Rule Order Considerations

Rules are executed in the order they're added:

```php
$v = new Validator(['email' => '']);

// 'required' is checked first
$v->rule('required', 'email');
$v->rule('email', 'email');

$v->validate(); // Fails on 'required'
```

### Stop on First Failure

For performance, stop after first failure:

```php
$v->stopOnFirstFail(true);
$v->rule('required', 'email');
$v->rule('email', 'email');
// Only one error message if 'required' fails
```

---

## Best Practices

### Use Fluent Syntax When

- You need custom messages per rule
- You want maximum readability
- You're adding rules conditionally

### Use Rule-Based Array When

- Applying the same rule to many fields
- Defining validation in configuration files
- You prefer grouping by rule type

### Use Field-Based Array When

- Organizing complex validation by field
- Each field has many rules
- You want to see all rules for a field together
