---
title: Language Manager
description: API reference for the LanguageManager class
---

The `LanguageManager` class handles internationalization (i18n) for validation messages, including language loading and secure file access.

:::note[Internal Class]
This is an internal class used by the `Validator`. Most users will interact with it through `Validator::lang()` and `Validator::langDir()`.
:::

```php
use Frostybee\Valicomb\Core\LanguageManager;
```

## Supported Languages

```php
private const ALLOWED_LANGUAGES = [
    'ar', 'cs', 'da', 'de', 'en', 'es', 'fa', 'fi', 'fr', 'hu',
    'id', 'it', 'ja', 'nl', 'no', 'pl', 'pt', 'ru', 'sv', 'tr', 'uk', 'zh',
];
```

| Code | Language |
|------|----------|
| `ar` | Arabic |
| `cs` | Czech |
| `da` | Danish |
| `de` | German |
| `en` | English (default) |
| `es` | Spanish |
| `fa` | Persian (Farsi) |
| `fi` | Finnish |
| `fr` | French |
| `hu` | Hungarian |
| `id` | Indonesian |
| `it` | Italian |
| `ja` | Japanese |
| `nl` | Dutch |
| `no` | Norwegian |
| `pl` | Polish |
| `pt` | Portuguese |
| `ru` | Russian |
| `sv` | Swedish |
| `tr` | Turkish |
| `uk` | Ukrainian |
| `zh` | Chinese |

---

## Static Methods

### lang()

Get or set the current language.

```php
public static function lang(?string $lang = null): string
```

| Parameter | Type | Description |
|-----------|------|-------------|
| `$lang` | string\|null | Language code to set, or null to get current |

**Returns:** The current language code (defaults to `'en'`).

```php
// Set language
LanguageManager::lang('fr');

// Get current language
$current = LanguageManager::lang(); // 'fr'
```

### langDir()

Get or set the language file directory.

```php
public static function langDir(?string $dir = null): string
```

| Parameter | Type | Description |
|-----------|------|-------------|
| `$dir` | string\|null | Directory path, or null to get current |

**Returns:** The current language directory path.

```php
// Set custom directory
LanguageManager::langDir('/path/to/custom/lang');

// Get current directory
$dir = LanguageManager::langDir();
```

### loadLanguage()

Load a language file securely.

```php
public static function loadLanguage(
    ?string $lang = null,
    ?string $langDir = null
): array
```

| Parameter | Type | Description |
|-----------|------|-------------|
| `$lang` | string\|null | Language code (defaults to current) |
| `$langDir` | string\|null | Directory path (defaults to current) |

**Returns:** The loaded language messages array.

**Throws:** `InvalidArgumentException` if:
- Language code is not in the allowed list
- Language file cannot be found or read
- Language file doesn't return an array

```php
$messages = LanguageManager::loadLanguage('es');
```

### Security Features

The `loadLanguage()` method includes security protections:

1. **Whitelist validation** - Only allowed language codes accepted
2. **Path traversal prevention** - Uses `basename()` to strip paths
3. **Real path resolution** - Validates directory exists
4. **File existence check** - Ensures file is readable

```php
// These will throw InvalidArgumentException
LanguageManager::loadLanguage('../../../etc/passwd');
LanguageManager::loadLanguage('invalid');
```

---

## Rule Message Methods

### getRuleMessages()

Get all loaded rule messages.

```php
public static function getRuleMessages(): array
```

**Returns:** Associative array of rule names to message templates.

### addRuleMessage()

Add a single rule message.

```php
public static function addRuleMessage(string $rule, string $message): void
```

| Parameter | Type | Description |
|-----------|------|-------------|
| `$rule` | string | The rule name |
| `$message` | string | The message template |

```php
LanguageManager::addRuleMessage('myRule', '{field} failed validation');
```

### addRuleMessages()

Add multiple rule messages.

```php
public static function addRuleMessages(array $messages): void
```

| Parameter | Type | Description |
|-----------|------|-------------|
| `$messages` | array | Associative array of rule names to messages |

```php
LanguageManager::addRuleMessages([
    'rule1' => '{field} failed rule 1',
    'rule2' => '{field} failed rule 2'
]);
```

### clearRuleMessages()

Clear all rule messages.

```php
public static function clearRuleMessages(): void
```

---

## Utility Methods

### getAllowedLanguages()

Get the list of supported language codes.

```php
public static function getAllowedLanguages(): array
```

**Returns:** Array of allowed language codes.

```php
$languages = LanguageManager::getAllowedLanguages();
// ['ar', 'cs', 'da', 'de', 'en', ...]
```

---

## Language File Format

Language files must be PHP files that return an associative array:

```php
// lang/en.php
return [
    'required' => '{field} is required',
    'email' => '{field} is not a valid email address',
    'min' => '{field} must be at least %s',
    'max' => '{field} must be at most %s',
    'between' => '{field} must be between %s and %s',
    'length' => '{field} must be exactly %s characters',
    'lengthMin' => '{field} must be at least %s characters',
    'lengthMax' => '{field} must be at most %s characters',
    // ... more rules
];
```

### Message Placeholders

| Placeholder | Description |
|-------------|-------------|
| `{field}` | Replaced with field name or label |
| `%s` | First parameter |
| `%d` | First parameter (as integer) |
| Additional `%s`/`%d` | Subsequent parameters |
